<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Nota de Pedido - Sur Maderas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/main.css">

    <!-- Librerías de Select2 para búsqueda en dropdown -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <!-- sweetalert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- jsPDF para generar el PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div class="container mt-5 p-4">
        <h2 class="mb-4 text-center">Generador de Nota de Pedido - Sur Maderas</h2>

        <form id="formulario">
            <!-- Fechas -->
            <div class="row mb-3">
                <div class="col">
                    <label>Fecha:</label>
                    <input type="date" class="form-control" id="fecha">
                </div>
                <div class="col">
                    <label>Entrega para el día:</label>
                    <select class="form-control" id="opcionEntrega" onchange="cambiarEntrega()">
                        <option value="15">15 días hábiles</option>
                        <option value="20">20 días hábiles</option>
                        <option value="especial">Entrega especial</option>
                    </select>
                    <input type="date" class="form-control mt-2" id="fechaEntrega" style="display:none;">
                </div>
            </div>

            <!-- Datos del cliente -->
            <div class="mb-3">
                <label>Señores:</label>
                <input type="text" class="form-control" id="seniores">
            </div>
            <div class="mb-3">
                <label>Teléfono:</label>
                <input type="text" class="form-control" id="telefono">
                <span id="error-telefono" class="text-danger" style="display:none; font-size: 0.9em;">Formato inválido. Ejemplo: (223) 595 4195</span>
            </div>

            <!-- Dropdown de vendedores -->
            <div class="mb-3">
                <label>Vendedor:</label>
                <select class="form-control" id="vendedor">
                    <option value="">Seleccione un vendedor</option>
                    <option value="Matías">Matías</option>
                    <option value="Valen">Valen</option>
                    <option value="Martin">Martin</option>
                    <option value="Ceci">Ceci</option>
                    <option value="Guille">Guille</option>
                    <option value="Ariel">Ariel</option>
                    <option value="Pato">Pato</option>
                </select>
            </div>

            <!-- Medio de pago -->
            <div class="mb-3">
                <label>Medio de pago:</label>
                <select class="form-control" id="transferidoA">
                    <option value="">Seleccione una opción</option>
                    <option value="Efectivo">Efectivo</option>
                    <option value="Transferencia">Transferencia</option>
                    <option value="Tarjeta">Tarjeta</option>
                </select>
            </div>

            <!-- Tipo de pago -->
            <div class="mb-3">
                <label>Estado de pago:</label>
                <select class="form-control" id="tipoPago">
                    <option value="">Seleccione una opción</option>
                    <option value="Pago completo">Pagado</option>
                    <option value="adelanto">Adelanto</option>
                </select>
            </div>

            <!-- Detalle del pedido -->
            <h5>Detalle del Pedido:</h5>
            <div id="detalles">
                <div class="row mb-2">
                    <div class="col-md-5">
                        <select class="form-control producto-select" name="producto[]">
                            <option value="">Seleccione un producto</option>
                            <option value="custom">Producto personalizado</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <input type="number" class="form-control cantidad" name="cantidad[]" placeholder="Cant." value="1" min="1">
                    </div>
                    <div class="col-md-3">
                        <input type="number" class="form-control precio" name="importe[]" placeholder="Precio">
                    </div>
                    <div class="col-md-2">
                        <input type="checkbox" class="form-check-input precio-especial" title="Precio especial">
                        <label class="form-check-label">Especial</label>
                    </div>
                </div>
            </div>
            <button type="button" class="agregar btn btn-secondary mb-3" onclick="agregarFilaProducto()">Agregar otro producto</button>

            <!-- Totales -->
            <div class="row mb-3">
                <div class="col">
                    <label>Total $:</label>
                    <input type="number" class="form-control" id="total" readonly>
                </div>
                <div class="col">
                    <label>Descuento $:</label>
                    <input type="number" class="form-control" id="descuento" value="0" min="0" readonly>
                </div>
                <div class="col">
                    <label>Adelanto $:</label>
                    <input type="number" class="form-control" id="adelanto" value="0" min="0">
                </div>
                <div class="col" id="resta-col">
                    <label>Resta $:</label>
                    <input type="number" class="form-control" id="resta" readonly>
                </div>
            </div>

            <!-- Botones principales -->
            <div class="d-flex flex-wrap gap-2">
                <button type="button" class="btn btn-success" onclick="guardarNota()">Guardar Nota</button>
                <button type="button" class="btn btn-primary" onclick="generarPDF()">Ver PDF</button>
                <button type="button" id="generarProveedor" class="btn btn-secondary">Generar Nota Proveedor</button>
                <button type="button" class="btn btn-info" onclick="verNotas()">Ver Notas</button>
                <button type="button" class="btn btn-warning" onclick="enviarPorWhatsApp()">Enviar por WhatsApp</button>
            </div>
        </form>
    </div>

    

    <!-- Configuración general -->
<script src="js/config.js"></script>

<!-- Utilidades comunes (validaciones, fechas, código único, etc.) -->
<script src="js/utils.js"></script>

<!-- Productos (carga y selects) -->
<script src="js/productos.js"></script>

<!-- PDF (dibujarPDF, generarPDF, generarNotaProveedor, etc.) -->
<script src="js/pdf.js"></script>

<!-- Guardar nota (guardarNotaEnBackend, guardarNota) -->
<script src="js/guardarnota.js"></script>

<!-- WhatsApp (enviarPorWhatsApp) -->
<script src="js/whatsapp.js"></script>

<!-- Script principal al final -->
<script src="js/main.js"></script>
    
</body>
</html>
